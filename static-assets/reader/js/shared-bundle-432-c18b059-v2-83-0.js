"use strict";(self.webpackChunkpartner_us_nsn_menominee_legislature=self.webpackChunkpartner_us_nsn_menominee_legislature||[]).push([[432],{2967(t,e,n){n.d(e,{A:()=>l});var o=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"component-slide-y",mode:"out-in"}},[t.visible?e("div",{staticClass:"pa-annotation note-disclaimer-simple"},[e("header",[e("h2",{staticClass:"h__ui--small"},[t._v("\n        Disclaimer\n      ")]),t._v(" "),e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.tip("Dismiss for a month in this browser"),expression:"tip('Dismiss for a month in this browser')"}],attrs:{buttonType:"icon",buttonText:"Dismiss for a month in this browser",iconRegular:"icon-ok-o",classRegular:"button--transparent",classCustom:"disclaimer-close"},on:{"on-click":t.dismissForAMonth}})],1),t._v(" "),e("section",[e("div",{domProps:{innerHTML:t._s(t.disclaimerText)}})])]):t._e()])};o._withStripped=!0;var i=n(3994),a=n(6981),s=(n(753),n(4334),n(4420),n(3814),n(9665),n(2781),n(5293),n(8284)),r=n(8119);const c={name:"NoteDisclaimerSimple",components:{SuperButton:n(6919).A},mixins:[r.A],data:function(){return{visible:!1}},computed:{disclaimerText:function(){return this.$store.getters["user/getUserData"].org?this.$store.getters["user/getUserData"].org.private_notes_disclaimer:""},localStorageDismissalKeyName:function(){return(0,s.A)(this.$store.getters["documentData/getLibraryTitle"])+"_annotation_disclaimer"}},mounted:function(){var t=this;return(0,a.A)((0,i.A)().m(function e(){return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t.isDismissed();case 1:e.v||""===t.disclaimerText||setTimeout(function(){t.visible=!0},500);case 2:return e.a(2)}},e)}))()},methods:{dismissForAMonth:function(){var t=(new Date).getTime();localStorage.setItem(this.localStorageDismissalKeyName,JSON.stringify({dismissedDate:t,dismissedUntil:t+26298e5})),this.visible=!1},isDismissed:function(){var t=this;return new Promise(function(e){var n=JSON.parse(localStorage.getItem(t.localStorageDismissalKeyName))||null,o=(new Date).getTime();Boolean(n)&&o<n.dismissedUntil?e(!0):e(!1)})}}};const l=(0,n(8598).A)(c,o,[],!1,null,null,null).exports},4112(t,e,n){n.d(e,{A:()=>v});var o=function(){var t=this,e=t._self._c;return e("div",{key:"cardview-".concat(t.uid),ref:"cardview-".concat(t.uid),class:["cardview",t.customCSSClasses],attrs:{id:"cardview-".concat(t.uid),tabindex:"0"}},[t.dialog.visible?e("ConfirmationDialog",{attrs:{uid:"cardview_item-".concat(t.uid),loading:t.dialog.loading,type:t.dialog.type,"msg-question":t.dialog.msg.question,"msg-confirm":t.dialog.msg.confirm,"msg-cancel":t.dialog.msg.cancel},on:{"on-cancel":t.onDialogCancel,"on-confirm":t.onDialogConfirm}}):t._e(),t._v(" "),t.hasHeaderSlot?e("header",{staticClass:"cardview__header"},[t._t("header",null,{mode:t.mode}),t._v(" "),e("div",{staticClass:"cardview__header__main-actions"},[e("CardViewDefaultActions",{attrs:{defaultActions:t.defaultActions,mode:t.mode},on:{"edit-click":t.toggleMode,"delete-click":t.onDeleteClick}}),t._v(" "),t._t("custom-actions")],2)],2):t._e(),t._v(" "),t.hasContentSlot?e("div",{staticClass:"cardview-content"},[t._t("content",null,{mode:t.mode,onEditCancel:t.activateViewMode,saveAndClose:t.activateViewMode})],2):t._e(),t._v(" "),t.hasFooterSlot?e("footer",{staticClass:"cardview__footer"},[t._t("footer")],2):t._e(),t._v(" "),t.hasFooterSlot?e("div",{ref:"cardview-tabs-".concat(t.uid),staticClass:"cardview-options",attrs:{id:"cardview-tabs-".concat(t.uid)}},[t._t("tabs",null,{mode:t.mode})],2):t._e()],1)};o._withStripped=!0;n(9665);var i=n(4636),a=n(253),s=n(9271),r=n(8119),c=(n(3754),function(){var t=this,e=t._self._c;return e("section",{ref:t.cid,staticClass:"confirmation-dialog",style:t.positionStyle,attrs:{id:t.cid,tabindex:"0",role:"dialog","aria-labelledby":"".concat(t.cid,"-message")},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.onCancel.apply(null,arguments)}}},[t.loading?e("Loader",{attrs:{type:"bar",position:"absolute"}}):t._e(),t._v(" "),e("p",{ref:"".concat(t.cid,"-message"),staticClass:"confirmation-dialog__message",attrs:{id:"".concat(t.cid,"-message")}},[t._v("\n    "+t._s(t.msgQuestion||"Do you confirm this action?")+"\n  ")]),t._v(" "),e("div",{staticClass:"confirmation-dialog__buttons"},[e("SuperButton",{ref:"".concat(t.cid,"-button-cancel"),attrs:{id:"".concat(t.cid,"-button-cancel"),classRegular:"button--outline","button-text":t.msgCancel||"Cancel",disabled:t.loading},on:{"on-click":t.onCancel}}),t._v(" "),e("SuperButton",{ref:"".concat(t.cid,"-button-confirm"),attrs:{id:"".concat(t.cid,"-button-confirm"),classRegular:"button--ui","button-text":t.msgConfirm||"Confirm",loading:t.loading,disabled:t.loading},on:{"on-click":t.onConfirm}})],1)],1)});c._withStripped=!0;var l=n(9841),u=n(6919);const d={name:"ConfirmationDialog",components:{Loader:l.A,SuperButton:u.A},mixins:[r.L],props:{uid:{type:String,default:null},componentData:{type:Object,default:null},loading:{type:Boolean,default:!1},msgQuestion:{type:String,default:"Do you confirm this action?"},msgCancel:{type:String,default:"Cancel"},msgConfirm:{type:String,default:"Confirm"},type:{type:String,default:"generic"},position:{type:String,default:"absolute"}},computed:{positionStyle:function(){return"absolute"!==this.$props.position&&"position: ".concat(this.$props.position,";")}},methods:{onCancel:function(){this.$emit("on-cancel",{type:this.$props.type,componentData:this.$props.componentData})},onConfirm:function(){this.$emit("on-confirm",{type:this.$props.type,componentData:this.$props.componentData})}}};var p=n(8598);const h=(0,p.A)(d,c,[],!1,null,null,null).exports;var m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"cardview-actions"},[t.defaultActions.edit?e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.editButtonToolTip,expression:"editButtonToolTip",modifiers:{top:!0}}],attrs:{buttonType:"icon","button-text":"Edit note","icon-regular":"icon-document-edit-small","class-regular":"button--transparent","class-selected":"button--outline","class-custom":"cardview-btn-edit",selected:t.editButtonSelected},on:{"on-click":t.onEditClick}}):t._e(),t._v(" "),t.defaultActions.delete?e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Delete"),expression:"tip('Delete')",modifiers:{top:!0}}],attrs:{buttonType:"icon","button-text":"Delete note","icon-regular":"icon-trash","class-regular":"button--transparent","class-custom":"cardview-btn-trash"},on:{"on-click":t.onDeleteClick}}):t._e()],1)};m._withStripped=!0;const f={name:"CardViewDefaultActions",components:{SuperButton:u.A},mixins:[r.A],props:{defaultActions:{type:Object},mode:{type:String,required:!0}},computed:{editButtonToolTip:function(){return this.$props.mode===i.A.EDIT_MODE?this.tip("Exit edit mode"):this.tip("Enter edit mode")},editButtonSelected:function(){return this.$props.mode===i.A.EDIT_MODE}},methods:{onEditClick:function(){this.$emit("edit-click")},onDeleteClick:function(){this.$emit("delete-click")}}};const _={name:"CardView",components:{ConfirmationDialog:h,CardViewDefaultActions:(0,p.A)(f,m,[],!1,null,null,null).exports},mixins:[s.A,r.A],props:{item:{type:Object,default:null},initialMode:{type:String,default:i.A.VIEW_MODE},customCSSClasses:{type:Array},customMessages:{type:Object},defaultActions:{type:Object,default:function(){return{edit:!1,delete:!1}}}},data:function(){return{mode:i.A.VIEW_MODE}},computed:{hasHeaderSlot:function(){return Boolean(this.$slots.header)||Boolean(this.$scopedSlots.header)},hasContentSlot:function(){return Boolean(this.$slots.content)||Boolean(this.$scopedSlots.content)},hasFooterSlot:function(){return Boolean(this.$slots.footer)||Boolean(this.$scopedSlots.footer)},hasTabsSlot:function(){return Boolean(this.$slots.tabs)||Boolean(this.$scopedSlots.tabs)},uid:function(){return"id"in this.$props.item?this.$props.item.id:"uid_"+Math.floor(1e9*Math.random()+1)}},created:function(){this.$props.initialMode&&(this.mode=this.$props.initialMode)},methods:{toggleMode:function(){this.mode===i.A.EDIT_MODE?this.mode=i.A.VIEW_MODE:this.mode===i.A.VIEW_MODE&&(this.mode=i.A.EDIT_MODE)},activateViewMode:function(){this.mode=i.A.VIEW_MODE},activateEditMode:function(){this.mode=i.A.EDIT_MODE},onDeleteClick:function(){this.dialog.type="delete",this.dialog.msg.question=this.$props.customMessages.deleteDialogMessage,this.dialog.msg.confirm=this.$props.customMessages.deleteDialogConfirm,this.dialog.msg.cancel=this.$props.customMessages.deleteDialogCancel,this.dialog.visible=!0,(0,a.A)("#cardview-".concat(this.$props.item.id," .pa-dialog"))},dialogReset:function(){this.dialog.visible=!1,this.dialog.type=null,this.dialog.value=null,this.dialog.msg.question=null,this.dialog.msg.cancel=null,this.dialog.msg.confirm=null},onDialogConfirm:function(t){"delete"===t.type&&(this.$emit("delete-confirmed"),this.dialogReset())},onDialogCancel:function(t){var e=this;"delete"===t.type&&(0,a.A)("#cardview-".concat(this.$props.item.id," .cardview-btn-trash")).finally(function(){e.dialogReset()})}}};const v=(0,p.A)(_,o,[],!1,null,null,null).exports},4636(t,e,n){n.d(e,{A:()=>o});n(5269);const o=Object.freeze({VIEW_MODE:"VIEW",EDIT_MODE:"EDIT"})},8354(t,e,n){n.d(e,{A:()=>ht});var o=function(){var t=this,e=t._self._c;return e("CardView",{attrs:{"aria-label":"Private Annotation","data-annotation-url":t.annotation.textranges[0].start_url,"data-annotation-id":t.annotation.id,item:t.annotation,initialMode:t.defaultViewMode,defaultActions:t.defaultActions,customMessages:t.customMessages,customCSSClasses:["pa-annotation"]},on:{"delete-confirmed":t.deleteConfirmed},scopedSlots:t._u([{key:"header",fn:function(){return[e("AnnotationBreadcrumbs",{attrs:{annotationURL:t.annotation.textranges[0].start_url,document_title:t.document_title,short_citation:t.short_citation}})]},proxy:!0},{key:"custom-actions",fn:function(){return[e("Actions",{attrs:{expand:!1,send:!1,share:!1}})]},proxy:!0},{key:"content",fn:function(n){return[e("AnnotationContent",{ref:"annotationContent",attrs:{category:"main",content:t.annotation.body,mode:n.mode},on:{"cancel-edit":function(e){return t.onEditCancel(e,n.onEditCancel)},"on-save":function(e){return t.onSave(e,n.saveAndClose)},"on-editor-autosave":function(e){Boolean(t.draft)&&t.saveDraftBody(e)}}})]}},{key:"footer",fn:function(){return[e("AnnotationAuthor",{attrs:{author:t.annotation.author}}),t._v(" "),e("AnnotationDate",{attrs:{date:t.annotation.created,current:t.annotation.current}})]},proxy:!0},{key:"tabs",fn:function(n){return[t.showTabs(n)?e("Tabs",{attrs:{annotation:t.annotation}}):t._e()]}}])})};o._withStripped=!0;var i=n(6505),a=(n(3772),n(9665),n(5636),n(221)),s=n(9217),r=n(4636),c=n(9724),l=n(253),u=n(9271),d=n(8119),p=n(4112),h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pa-annotation__header__main-actions"},[t.send?e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Send note"),expression:"tip('Send note')",modifiers:{top:!0}}],attrs:{"button-text":"Send note link over email",buttonType:"icon","icon-regular":"icon-email","class-regular":"button--transparent","class-custom":"pa-annotation-btn-send"},on:{"on-click":function(e){return t.actionRespond("send")}}}):t._e(),t._v(" "),t.share?e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Share note"),expression:"tip('Share note')",modifiers:{top:!0}}],attrs:{"button-text":"Share note link",buttonType:"icon","icon-regular":"icon-share","class-regular":"button--transparent","class-custom":"pa-annotation-btn-share"},on:{"on-click":function(e){return t.actionRespond("share")}}}):t._e(),t._v(" "),t.expand?e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Expand note"),expression:"tip('Expand note')",modifiers:{top:!0}}],attrs:{"button-text":"Expand note",buttonType:"icon","icon-regular":"icon-expand","class-regular":"button--transparent","class-custom":"pa-annotation-btn-expand"},on:{"on-click":function(e){return t.actionRespond("expand")}}}):t._e()],1)};h._withStripped=!0;var m=n(6919);const f={name:"Actions",components:{SuperButton:m.A},mixins:[d.A],props:{expand:{type:Boolean,default:null},send:{type:Boolean,default:null},share:{type:Boolean,default:null}},computed:{defaultActions:function(){return this.$store.getters["privateNotes/getDefaultActions"]}},methods:{isActivated:function(t){return null!==this.$props[t]&&this.$props[t]},actionRespond:function(t){this.$emit("on-action",t)}}};var _=n(8598);const v=(0,_.A)(f,h,[],!1,null,null,null).exports;var g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pa-author",attrs:{"aria-label":"Author"}},[e("span",[t._v("â€” By")]),t._v(" "),t.userEmail?e("a",{staticClass:"user-name",attrs:{href:"mailto:".concat(t.userEmail),target:"_blank"}},[t._v("\n    "+t._s(t.authorOrAccount)+"\n  ")]):e("span",{staticClass:"user-name"},[t._v("\n    "+t._s(t.authorOrAccount)+"\n  ")])])};g._withStripped=!0;const b={name:"AnnotationAuthor",props:{author:{type:Object,required:!0}},computed:{userEmail:function(){return"email"in this.$props.author&&""!==this.$props.author.email&&this.$props.author.email},emailAccount:function(){return!!this.userEmail&&this.userEmail.split("@")[0]},authorFullName:function(){return this.$props.author.first_name+" "+this.$props.author.last_name},authorOrAccount:function(){return""!==this.authorFullName.trim()?this.authorFullName:this.emailAccount||"Anonymous"}}};const y=(0,_.A)(b,g,[],!1,null,null,null).exports;var A=function(){var t=this,e=t._self._c;return e("div",["EDIT"==t.mode?e("EditorBasic",{ref:"editor",attrs:{content:t.filteredHtml},on:{"on-save":t.saveContent,"on-cancel":t.cancelEdit,"on-auto":t.onEditorAutosave}}):e("div",{staticClass:"cardview-content__content",domProps:{innerHTML:t._s(t.filteredHtml)}})],1)};A._withStripped=!0;var S=n(7925),w=function(){var t=this,e=t._self._c;return e("div",{ref:t.cid,staticClass:"editor editor--basic",attrs:{id:t.cid}},[t.disabled?e("div",{staticClass:"ProseMirror ProseMirror-disabled",domProps:{innerHTML:t._s(t.content)}}):t._e(),t._v(" "),t.disabled?t._e():e("ActionsBasic",{attrs:{"active-paragraph":t.editor.isActive("paragraph"),"active-title-large":t.editor.isActive("heading",{level:1}),"active-title-small":t.editor.isActive("heading",{level:2}),"active-bold":t.editor.isActive("bold"),"active-italic":t.editor.isActive("italic"),"active-strike":t.editor.isActive("strike"),"active-bullet-list":t.editor.isActive("bulletList"),"active-ordered-list":t.editor.isActive("orderedList")},on:{"on-paragraph":t.onParagraph,"on-title-large":t.onTitleLarge,"on-title-small":t.onTitleSmall,"on-bold":t.onBold,"on-italic":t.onItalic,"on-strike":t.onStrike,"on-bullet-list":t.onBulletList,"on-ordered-list":t.onOrderedList}}),t._v(" "),t.disabled?t._e():e("EditorContent",{key:"".concat(t.cid,"_prosemirror"),attrs:{editor:t.editor,"aria-label":"Editor text content"}}),t._v(" "),e("div",{staticClass:"editor__actions"},[e("SuperButton",{attrs:{"button-text":"Cancel","class-regular":"button--outline","class-custom":"editor__actions__cancel"},on:{"on-click":t.onCancel}}),t._v(" "),e("SuperButton",{attrs:{"button-text":"Save and close","class-regular":"button--ui","class-custom":"editor__actions__save",disabled:t.isSaveDisabled},on:{"on-click":t.onSave}})],1)],1)};w._withStripped=!0;n(970),n(5293);var k=n(7256),C=n(129),D=function(){var t=this,e=t._self._c;return e("div",{staticClass:"editor-actions-basic"},[e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Bold"),expression:"tip('Bold')",modifiers:{top:!0}}],attrs:{buttonType:"icon",iconRegular:"icon-bold","button-text":"Bold",classRegular:"button-marker",classSelected:"button-marker button-marker--active",classCustom:"button-marker--bottom",selected:t.activeBold},on:{"on-click":t.emitBold}}),t._v(" "),e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Italic"),expression:"tip('Italic')",modifiers:{top:!0}}],attrs:{buttonType:"icon",iconRegular:"icon-italic","button-text":"Italic",classRegular:"button-marker",classSelected:"button-marker button-marker--active",classCustom:"button-marker--bottom",selected:t.activeItalic},on:{"on-click":t.emitItalic}}),t._v(" "),e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Strike through"),expression:"tip('Strike through')",modifiers:{top:!0}}],attrs:{buttonType:"icon",iconRegular:"icon-strike","button-text":"Strike through",classRegular:"button-marker",classSelected:"button-marker button-marker--active",classCustom:"button-marker--bottom",selected:t.activeStrike},on:{"on-click":t.emitStrike}}),t._v(" "),e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Ordered list"),expression:"tip('Ordered list')",modifiers:{top:!0}}],attrs:{buttonType:"icon",iconRegular:"icon-list-ordered","button-text":"Ordered list",classRegular:"button-marker",classSelected:"button-marker button-marker--active",classCustom:"button-marker--bottom",selected:t.activeOrderedList},on:{"on-click":t.emitOrderedList}}),t._v(" "),e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Unordered list"),expression:"tip('Unordered list')",modifiers:{top:!0}}],attrs:{buttonType:"icon",iconRegular:"icon-list-unordered","button-text":"Unordered list",classRegular:"button-marker",classSelected:"button-marker button-marker--active",classCustom:"button-marker--bottom",selected:t.activeBulletList},on:{"on-click":t.emitBulletList}}),t._v(" "),e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Large title"),expression:"tip('Large title')",modifiers:{top:!0}}],attrs:{buttonType:"icon",iconRegular:"icon-title-1","button-text":"Large title",classRegular:"button-marker",classSelected:"button-marker button-marker--active",classCustom:"button-marker--bottom",selected:t.activeTitleLarge},on:{"on-click":t.emitTitleLarge}}),t._v(" "),e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Small title"),expression:"tip('Small title')",modifiers:{top:!0}}],attrs:{buttonType:"icon",iconRegular:"icon-title-2","button-text":"Small title",classRegular:"button-marker",classSelected:"button-marker button-marker--active",classCustom:"button-marker--bottom",selected:t.activeTitleSmall},on:{"on-click":t.emitTitleSmall}}),t._v(" "),e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Paragraph"),expression:"tip('Paragraph')",modifiers:{top:!0}}],attrs:{buttonType:"icon",iconRegular:"icon-paragraph","button-text":"Paragraph",classRegular:"button-marker",classSelected:"button-marker button-marker--active",classCustom:"button-marker--bottom",selected:t.activeParagraph},on:{"on-click":t.emitParagraph}})],1)};D._withStripped=!0;const $={name:"ActionsBasic",components:{SuperButton:m.A},mixins:[d.L],props:{activeParagraph:{type:Boolean,default:!1},activeTitleLarge:{type:Boolean,default:!1},activeTitleSmall:{type:Boolean,default:!1},activeBold:{type:Boolean,default:!1},activeItalic:{type:Boolean,default:!1},activeStrike:{type:Boolean,default:!1},activeBulletList:{type:Boolean,default:!1},activeOrderedList:{type:Boolean,default:!1}},methods:{emitParagraph:function(){this.$emit("on-paragraph",!0)},emitTitleLarge:function(){this.$emit("on-title-large",!0)},emitTitleSmall:function(){this.$emit("on-title-small",!0)},emitBold:function(){this.$emit("on-bold",!0)},emitItalic:function(){this.$emit("on-italic",!0)},emitUnderline:function(){this.$emit("on-underline",!0)},emitStrike:function(){this.$emit("on-strike",!0)},emitBulletList:function(){this.$emit("on-bullet-list",!0)},emitOrderedList:function(){this.$emit("on-ordered-list",!0)}}};const x=(0,_.A)($,D,[],!1,null,null,null).exports;var O=n(7651);const I={name:"EditorBasic",components:{EditorContent:k.$Z,ActionsBasic:x,SuperButton:m.A},mixins:[d.L],props:{uid:{type:String,default:null},disabled:{type:Boolean,default:!1},content:{type:String,default:"<p>Loading...</p>"},autosave:{type:Number,default:100}},data:function(){return{editor:null,autosaveContent:""}},computed:{isSaveDisabled:function(){var t=(new DOMParser).parseFromString(this.autosaveContent,"text/html").body;return null===this.editor||null===t.innerText||""===t.innerText.trim()||this.$props.disabled}},watch:{autosaveContent:function(t,e){t!==e&&this.onAuto()}},created:function(){this.editor=new k.KE({content:this.content,extensions:[C.A]})},mounted:function(){var t=this;null!==this.$props.autosave&&setInterval(function(){t.autosaveContent=t.editor.getHTML()},this.$props.autosave),(0,O.A)("#".concat(this.cid," .ProseMirror")).then(function(t){t.setAttribute("aria-label","Editor text content")})},beforeDestroy:function(){this.editor.destroy()},methods:{onSave:function(){this.$emit("on-save",this.editor.getHTML())},onCancel:function(){this.$emit("on-cancel",!0)},onAuto:function(){this.$emit("on-auto",this.editor.getHTML())},onParagraph:function(){this.editor.chain().focus().setParagraph().run()},onTitleLarge:function(){this.editor.chain().focus().toggleHeading({level:1}).run()},onTitleSmall:function(){this.editor.chain().focus().toggleHeading({level:2}).run()},onBold:function(){this.editor.chain().focus().toggleBold().run()},onItalic:function(){this.editor.chain().focus().toggleItalic().run()},onStrike:function(){this.editor.chain().focus().toggleStrike().run()},onBulletList:function(){this.editor.chain().focus().toggleBulletList().run()},onOrderedList:function(){this.editor.chain().focus().toggleOrderedList().run()}}};const T={name:"AnnotationContent",components:{EditorBasic:(0,_.A)(I,w,[],!1,null,null,null).exports},props:{category:{type:String,default:"main"},content:{type:String,default:""},mode:{type:String,required:!0}},computed:{filteredHtml:function(){return(0,S.A)(this.$props.content)}},methods:{cancelEdit:function(){this.$emit("cancel-edit",!0)},saveContent:function(t){this.$emit("on-save",t)},saveAndExit:function(){this.$refs.editor.onSave()},onEditorAutosave:function(t){this.$emit("on-editor-autosave",t)}}};const B=(0,_.A)(T,A,[],!1,null,null,null).exports;var E=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pa-date"},[e("span",[t._v("on")]),t._v(" "),t.current?e("span",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip(t.messageCurrent),expression:"tip(messageCurrent)",modifiers:{top:!0}}],staticClass:"pa-date__date"},[t._v("\n    "+t._s(t.annotationDate)+"\n  ")]):e("span",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip(t.messageOutdated),expression:"tip(messageOutdated)",modifiers:{top:!0}}],staticClass:"pa-date__date"},[t._v("\n    "+t._s(t.annotationDate)+"\n  ")])])};E._withStripped=!0;var M=n(6607);const N={name:"AnnotationDate",mixins:[d.A,M.A],props:{date:{type:String,required:!0},current:{type:Boolean,default:!0}},computed:{messageOutdated:function(){return"<b>This annotation is outdated</b><br>Selected text was changed since the annotation was created."},messageCurrent:function(){return"This annotation is current"},annotationDate:function(){return this.localizedDate(this.$props.date)}}};const P=(0,_.A)(N,E,[],!1,null,null,null).exports;var L=function(){var t=this,e=t._self._c;return e("div",{staticClass:"pa-annotation__header__breadcrumb"},[t.document_title||t.short_citation?e("div",[e("a",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Jump to annotated part of the document"),expression:"tip('Jump to annotated part of the document')",modifiers:{top:!0}}],attrs:{href:t.annotationURL},on:{click:function(e){return e.preventDefault(),t.jumpToAnnotation.apply(null,arguments)}}},[e("span",{class:["icon",t.icon("icon-link")],attrs:{"aria-hidden":"true"}}),t._v(" "),e("span",{staticClass:"text"},[e("span",{staticClass:"text__breadcrumb"},[t._v("\n          "+t._s(t.document_title)+"\n        ")]),t._v(" "),e("span",{staticClass:"text__breadcrumb"},[t._v("\n          "+t._s(t.short_citation)+"\n        ")])])])]):e("Loader",{attrs:{type:"spinner"}})],1)};L._withStripped=!0;var R=n(3994),q=n(6981),U=(n(1097),n(2930),n(1341)),K=n(5737),V=n(9841);const F={name:"AnnotationBreadcrumbs",components:{Loader:V.A},mixins:[d.A],props:{annotationURL:{type:String},document_title:{type:String},short_citation:{type:String}},methods:{urlToMarginaliaId:function(t){return t?"marginalia_"+t.replace(/[^a-zA-Z0-9]/g,"_"):""},jumpToAnnotation:function(){var t=this;return(0,q.A)((0,R.A)().m(function e(){var n;return(0,R.A)().w(function(e){for(;;)switch(e.n){case 0:if((n=t.$props.annotationURL)===t.$route.path){e.n=4;break}return"mobile"!==t.$mq&&"phablet"!==t.$mq||t.$store.commit("structure/setMainMenuOpen",!1),e.n=1,t.$store.dispatch("app/loadDocument",{url:n,skipScroll:!0});case 1:return e.n=2,(0,l.A)("#main-content");case 2:return e.n=3,t.$store.dispatch("app/buildSearchScope");case 3:(0,U.A)(t.urlToMarginaliaId(n)||t.$store.getters["document/getCurrentDocument"].url),(0,K.A)(t.$store.getters["document/getSkipNextScroll"]),t.$store.commit("loading/setLoading",{type:"document",status:!1});case 4:return e.a(2)}},e)}))()}}};const H=(0,_.A)(F,L,[],!1,null,null,null).exports;n(3754),n(8192);var W=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"cardview-options__tabs"},[e("ul",{attrs:{role:"tablist"}},t._l(t.tabs,function(n,o){return e("li",{key:"pa-tab-".concat(t.annotation.id,"-").concat(o),class:["tab",t.isTabActive(n.id)?"tab--active":"tab--inactive"],attrs:{id:"pa-tab-".concat(t.annotation.id,"-").concat(o),role:"presentation"}},[e("a",{attrs:{tabindex:"0",id:"pa-tab-".concat(t.annotation.id,"-").concat(o,"-link"),role:"tab"},on:{click:function(e){return t.activateTab(n.id)},keypress:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.activateTab(n.id)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"])?null:t.activateTab(n.id)}]}},[t._v("\n          "+t._s(n.name)+"\n        ")])])}),0)]),t._v(" "),t.hasManagePermission?e("TabShare",{directives:[{name:"show",rawName:"v-show",value:t.tabCollabActive,expression:"tabCollabActive"}],attrs:{annotationId:t.annotation.id,hidden:!t.tabCollabActive}}):t._e()],1)};W._withStripped=!0;n(7604),n(1192),n(6282),n(5963),n(2829);var j=function(){var t=this,e=t._self._c;return e("section",{ref:"pa-panel-collab-".concat(t.annotationId),staticClass:"cardview-options__option",attrs:{id:"pa-panel-collab-".concat(t.annotationId),role:"tabpanel","aria-label":"Shares",tabindex:"0"}},[e("ShareSearch",{attrs:{annotationId:t.annotationId,uid:"pa-share-search-".concat(t.annotationId)}}),t._v(" "),e("ShareList",{attrs:{annotationId:t.annotationId,uid:"pa-share-list-".concat(t.annotationId)}})],1)};j._withStripped=!0;var G=function(){var t=this,e=t._self._c;return e("div",{ref:t.cid,staticClass:"pa-search-input",attrs:{id:t.cid}},[e("SearchInput",{attrs:{loading:t.loading,uid:"pa-share-search-".concat(t.annotationId),placeholder:"Share with..."},on:{"on-auto":t.onNewQuery,"on-enter":t.manualSearchRequest}}),t._v(" "),e("SuperButton",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:t.tip("Find groups and people to share this note with"),expression:"tip('Find groups and people to share this note with')",modifiers:{top:!0}}],attrs:{"button-text":"Search",buttonType:"icon","icon-regular":"icon-search","class-regular":"button--ui","class-custom":"pa-search-button",disabled:t.isSearchBtnDisabled},on:{"on-click":t.manualSearchRequest}}),t._v(" "),e("AutocompleteDropdown",{attrs:{uid:"pa-share-search-dropdown-".concat(t.annotationId),annotationId:t.annotationId,options:t.options,visible:t.menuVisible,label:"Share with..."},on:{"on-close-menu":t.closeDropdown,"on-select":t.onSelected}})],1)};G._withStripped=!0;var z=n(1083),J=(n(5232),n(3814),function(){var t=this,e=t._self._c;return e("div",{ref:t.cid,staticClass:"search-input",attrs:{id:t.cid}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],attrs:{id:"".concat(t.cid,"-input"),type:"search",placeholder:t.onFocus},domProps:{value:t.query},on:{focus:function(e){t.isFocused=!0},blur:function(e){t.isFocused=!1},keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onEnter.apply(null,arguments)},input:function(e){e.target.composing||(t.query=e.target.value)}}}),t._v(" "),t.loading?e("Loader",{attrs:{type:"spinner"}}):t._e()],1)});J._withStripped=!0;var Q=n(4242),Y=n.n(Q);const Z={name:"SearchInput",components:{Loader:V.A},mixins:[d.L],props:{uid:{type:String,default:null},placeholder:{type:String,default:"Search..."},loading:{type:Boolean,default:!1}},data:function(){return{isFocused:!1,query:""}},computed:{onFocus:function(){return this.isFocused?"":this.$props.placeholder}},watch:{query:function(t,e){t!==e&&this.throttledRequestSearch()}},created:function(){this.throttledRequestSearch=Y()(this.requestSearch,1e3,{leading:!1})},methods:{requestSearch:function(){this.$emit("on-auto",this.query.trim())},onEnter:function(){this.$emit("on-enter",this.query.trim())}}};const X=(0,_.A)(Z,J,[],!1,null,null,null).exports;var tt=function(){var t=this,e=t._self._c;return t.isVisible?e("div",{ref:t.cid,staticClass:"pa-autocomplete-dropdown",attrs:{id:t.cid}},[e("div",{staticClass:"pa-autocomplete-dropdown__label"},[t._v("\n    "+t._s(t.label)+"\n  ")]),t._v(" "),e("ul",{ref:"collab-options-".concat(t.annotationId),staticClass:"pa-autocomplete-dropdown__list",attrs:{id:"collab-options-".concat(t.annotationId),tabindex:"0",role:"listbox","aria-label":"Options","aria-activedescendant":t.activedescendant},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.closeMenu()},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.stopPropagation(),e.preventDefault(),t.focusUp())},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.stopPropagation(),e.preventDefault(),t.focusUp())},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.stopPropagation(),e.preventDefault(),t.focusDown())},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"right",39,e.key,["Right","ArrowRight"])||"button"in e&&2!==e.button||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.stopPropagation(),e.preventDefault(),t.focusDown())}]}},t._l(t.selections,function(n,o){return e("li",{key:"collab-option-".concat(t.annotationId,"-").concat(o),staticClass:"pa-autocomplete-dropdown__list__option",attrs:{id:"collab-option-".concat(t.annotationId,"-").concat(o),tabindex:"0",role:"option"},on:{click:[function(e){return e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.selectOptionAndClose(n.option_id)},function(e){return e.ctrlKey?e.shiftKey||e.altKey||e.metaKey?null:t.selectOption(n.option_id):null}],keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.stopPropagation(),e.preventDefault(),t.selectOptionAndClose(n.option_id))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"space",32,e.key,[" ","Spacebar"])?null:(e.stopPropagation(),e.preventDefault(),t.selectOption(n.option_id))},function(e){return e.type.indexOf("key")||33===e.keyCode?(e.stopPropagation(),e.preventDefault(),t.focusOption(0)):null},function(e){return e.type.indexOf("key")||34===e.keyCode?(e.stopPropagation(),e.preventDefault(),t.focusOption(t.selections.length)):null}]}},[e("div",{class:["collab-icon","icon",t.collabIcon(n.type)],attrs:{"aria-hidden":"true"}}),t._v(" "),e("div",{class:["pa-autocomplete-dropdown__list__option__name",t.selectedOptionStyle(n.option_selected)]},[t._v("\n        "+t._s(n.name)+"\n      ")]),t._v(" "),n.option_selected?e("div",{key:"collaborator_selection_".concat(t.annotationId,"_s").concat(o),class:["icon",t.icon("icon-ok")],attrs:{"aria-label":"Selected"}}):e("div",{key:"collaborator_selection_".concat(t.annotationId,"_n").concat(o),staticClass:"icon",attrs:{"aria-hidden":"true"}})])}),0),t._v(" "),e("div",{staticClass:"pa-autocomplete-dropdown__actions"},[e("div",{directives:[{name:"tooltip",rawName:"v-tooltip.top.click",value:t.tip(t.help),expression:"tip(help)",modifiers:{top:!0,click:!0}}],staticClass:"button button--transparent button--icon button--no-outline",attrs:{"aria-label":"Help",role:"note",tabindex:"0"}},[e("span",{class:["icon",t.icon("icon-info-o")],attrs:{"aria-hidden":"true"}}),t._v(" "),e("span",{staticClass:"visually-hidden"},[t._v("\n        "+t._s(t.help)+"\n      ")])]),t._v(" "),e("SuperButton",{attrs:{buttonType:"icon","button-text":"Close","icon-regular":"icon-x","class-regular":"button--transparent button--corner-close"},on:{"on-click":t.closeMenu}})],1)]):t._e()};tt._withStripped=!0;n(3466),n(5259),n(2956),n(5968),n(9787),n(6406),n(6110),n(7202);const et={methods:{collabIcon:function(t){return"org"===t?this.icon("icon-flag"):"org group"===t?this.icon("icon-group"):this.icon("icon-user-o")}}},nt={name:"AutocompleteDropdown",components:{SuperButton:m.A},mixins:[d.A,et],props:{uid:{type:String,default:null},annotationId:{type:Number,required:!0},options:{type:Array,default:function(){return[{name:"Default item",value:!1,type:!1}]}},label:{type:String,default:"Results"},visible:{type:Boolean,default:!1}},data:function(){return{selections:[]}},computed:{selectedOptions:function(){return this.selections.filter(function(t){return t.option_selected})},selectedOptionsCleaned:function(){var t=[],e=0;return Array.isArray(this.selectedOptions)&&0!==this.selectedOptions.length?(this.selectedOptions.forEach(function(n){t.push((0,i.A)({},n)),delete t[e].option_selected,delete t[e].option_focused,delete t[e].option_id,e++}),t):t},focusedOption:function(){return this.selections.find(function(t){return!0===t.option_focused})},isVisible:function(){return this.visible&&this.selections.length>0},activedescendant:function(){return!!(this.focusedOption&&"option_id"in this.focusedOption&&this.focusedOption.option_id)&&"collab-option-".concat(this.annotationId,"-").concat(this.focusedOption.option_id)},help:function(){return"<b>Help</b>\n<p>\n  To create multiple selections press <em><b>CTRL + click.</b></em><br>\n  You can also use keyboard <em><b>arrows</b></em> and <em><b>SPACE</b></em> to make multiple selections.<br>\n  Press <em><b>ENTER</b></em> or <em><b>left click</b></em> on an item to confirm a selection.\n</p>"}},watch:{options:function(){this.prepareOptions()},visible:function(){this.resetFocus()}},created:function(){this.prepareOptions()},mounted:function(){},methods:{returnOptionById:function(t){return this.selections.find(function(e){return e.option_id===t})},closeMenu:function(){this.$emit("on-close-menu",!0)},prepareOptions:function(){var t=0;this.selections=this.options.map(function(e){return(0,i.A)({option_selected:!1,option_focused:0===t,option_id:t++},e)})},resetFocus:function(){this.selections.forEach(function(t){0===t.option_id?t.option_focused=!0:t.option_focused=!1})},selectOption:function(t){var e=t;Number(e)>=this.selections.length?e=this.selections.length-1:Number(e)<0&&(e=0),this.selections.forEach(function(t){t.option_id===e&&(t.option_selected=!t.option_selected,t.option_focused=!0)})},selectOptionAndClose:function(t){this.returnOptionById(t).option_selected||this.selectOption(t),this.$emit("on-select",{uid:this.$props.uid,selected:this.selectedOptionsCleaned}),this.closeMenu()},focusOption:function(t){var e=t;Number(e)>=this.selections.length?e=this.selections.length-1:Number(e)<0&&(e=0),this.selections.forEach(function(t){t.option_focused=t.option_id===e}),this.$refs["collab-options-".concat(this.annotationId)].children[Number(this.focusedOption.option_id)].focus()},focusDown:function(){this.focusOption(this.focusedOption.option_id+1)},focusUp:function(){this.focusOption(this.focusedOption.option_id-1)},selectedOptionStyle:function(t){return!!t&&"option--selected"}}};const ot={name:"ShareSearch",components:{SearchInput:X,AutocompleteDropdown:(0,_.A)(nt,tt,[],!1,null,null,null).exports,SuperButton:m.A},mixins:[d.A],props:{uid:{type:String,default:null},annotationId:{type:Number,required:!0}},data:function(){return{loading:!1,query:"",querySearched:!1,options:[],selected:[],menuVisible:!1}},computed:{isSearchBtnDisabled:function(){return!Boolean(this.query)}},watch:{query:function(t,e){t!==e&&""!==t?this.automaticSearchRequest():this.resetSearchForm()}},methods:{closeDropdown:function(){var t=this;(0,l.A)("#pa-share-search-".concat(this.annotationId,"-input")).finally(function(){t.menuVisible=!1})},onNewQuery:function(t){this.query=t},resetSearchForm:function(){this.query=null,this.loading=!1,this.querySearched=!1},collabApiSearch:function(){var t=this;return new Promise(function(e,n){Boolean(t.query)?s.A.get("".concat(t.$store.getters["user/getPortalURL"],"/names?")+"filter=".concat(t.query,"&")+"content_type=annotation&"+"content_id=".concat(t.annotationId),{withCredentials:!0}).then(function(n){e(t.prepareResults(n.data))}).catch(function(t){console.error(t),n(t)}):e(!1)})},prepareResults:function(t){var e=t.users,n=t["org groups"],o=t.org,a=[];return e=e.map(function(t){return{id:t.id,name:"".concat(t.first_name," ").concat(t.last_name),type:"user",content_id:t.type}}),a=a.concat(e),n=n.map(function(t){return(0,i.A)((0,i.A)({},t),{},{type:"org group",content_id:t.type})}),a=a.concat(n),0!==Object.keys(o).length&&a.push((0,i.A)((0,i.A)({},o),{},{content_id:o.type,type:"org"})),a},onApiResponse:function(t){t?(this.options=t,this.menuVisible=!0,this.querySearched=!0,this.$announcer.set("Autocomplete form found ".concat(t.length," ").concat(t.length>1?"results":"result"))):(this.options=[],this.menuVisible=!1,this.querySearched=!1,this.$announcer.set("Autocomplete form is reset"))},onApiError:function(t){this.options=[],this.menuVisible=!1,this.querySearched=!1,this.$store.commit("sharedMessages/addPopupMessage",{type:"error",title:"Private notes share",text:"Unable to search: ".concat(t),announce:"Unable to search: ".concat(t),timeout:5e3}),console.error(t)},onSelected:function(t){var e=this;this.selected=t.selected;var n,o=(0,z.A)(this.selected);try{var i=function(){var t=n.value,o={shared_content_id:e.annotationId,shared_with_id:t.id,shared_content_type:e.$store.getters["privateNotes/getAnnotationContentTypeID"],shared_with_type:t.content_id,permission:"VIEW"};s.A.post("".concat(e.$store.getters["user/getPortalURL"],"/share"),o).then(function(n){e.$store.dispatch("privateNotes/addNewShare",{annotationId:e.annotationId,share:{share_id:n.data.share_id,shared_with_type:n.data.shared_with_type,shared_with_id:n.data.shared_with_id,permission:n.data.permission,shared_with_type_label:t.type,shared_with_label:t.name}}),e.$store.commit("sharedMessages/addPopupMessage",{type:"success",title:"Private notes",text:"Successfully shared with ".concat(t.name),announce:"Successfully shared with ".concat(t.name),timeout:5e3})}).catch(function(t){console.error(t)})};for(o.s();!(n=o.n()).done;)i()}catch(t){o.e(t)}finally{o.f()}this.$emit("on-selected",t.selected)},focusFirstResult:function(){this.menuVisible&&(0,l.A)("#collab-option-".concat(this.annotationId,"-0"))},automaticSearchRequest:function(){var t=this;this.loading=!0,this.collabApiSearch().then(function(e){return t.onApiResponse(e)}).catch(function(e){return t.onApiError(e)}).finally(function(){t.loading=!1})},manualSearchRequest:function(t){var e=this;this.query=t,this.querySearched&&this.options.length>0?(this.menuVisible=!0,this.focusFirstResult()):(this.loading=!0,this.collabApiSearch().then(function(t){e.onApiResponse(t),t&&e.focusFirstResult()}).catch(function(t){return e.onApiError(t)}).finally(function(){e.loading=!1}))}}};const it=(0,_.A)(ot,G,[],!1,null,null,null).exports;var at=function(){var t=this,e=t._self._c;return e("div",{ref:t.uid,staticClass:"pa-collab-users",attrs:{id:t.uid}},[t.isShared?e("div",[t._m(0),t._v(" "),e("section",{staticClass:"pa-collab-users__list"},[e("ul",t._l(t.sharedWith,function(n){return e("ListItem",{key:"panel_collab__list__user_".concat(t.annotationId,"_").concat(n.share_id),attrs:{uid:t.uid,annotationId:t.annotationId,componentData:n,loading:t.isLoading(n.share_id),locked:t.isOnlyManager(n)},on:{"on-delete":t.shareDelete,"on-access-change":t.shareAccessChange}})}),1)])]):e("div",{staticClass:"pa-collab-users__info"},[e("p",[e("span",{class:["icon",t.icon("icon-info")],attrs:{"aria-hidden":"true"}}),t._v("\n      This annotation hasn't been shared.\n    ")])])])};at._withStripped=!0;n(8494),n(8080);var st=function(){var t=this,e=t._self._c;return e("li",{staticClass:"pa-collab-users__list__option",attrs:{id:"panel_collab__list__user_".concat(t.annotationId,"_").concat(t.componentData.share_id)}},[e("div",{staticClass:"pa-collab-users__list__option__icon"},[t.loading?e("Loader",{attrs:{type:"spinner"}}):e("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.tip(t.sharedOptionType(t.componentData.shared_with_type_label)),expression:"(tip(sharedOptionType(componentData.shared_with_type_label)))"}],class:["collab-icon","icon",t.collabIcon(t.componentData.shared_with_type_label)],attrs:{"aria-hidden":"true"}})],1),t._v(" "),e("div",{staticClass:"pa-collab-users__list__option__name"},[t._v("\n    "+t._s(t.componentData.shared_with_label)+"\n  ")]),t._v(" "),e("div",{staticClass:"pa-collab-users__list__option__dropdown"},[e("SelectDropdown",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.tip("Sharing access level"),expression:"tip('Sharing access level')"}],attrs:{uid:"collab_".concat(t.annotationId,"_").concat(t.componentData.share_id),options:t.access,"default-option":t.defaultOption,disabled:t.isLocked,componentData:t.componentData,position:"bottom-right"},on:{"on-select":t.changeAccess}})],1),t._v(" "),e("div",{staticClass:"pa-collab-users__list__option__delete"},[e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.tip("Stop sharing with <b>".concat(t.componentData.shared_with_label,"</b>")),expression:"tip(`Stop sharing with <b>${componentData.shared_with_label}</b>`)"}],staticClass:"button button--transparent button--icon",attrs:{"aria-label":"Stop sharing with ".concat(t.componentData.shared_with_label),disabled:t.isLocked},on:{click:t.deleteItem}},[e("span",{class:["icon",t.icon("icon-x")],attrs:{"aria-hidden":"true"}})])])])};st._withStripped=!0;const rt={name:"ListItem",components:{SelectDropdown:n(744).A,Loader:V.A},mixins:[d.A,et],props:{uid:{type:String,default:null},annotationId:{type:Number,required:!0},componentData:{type:Object,default:null},loading:{type:Boolean,default:!1},locked:{type:Boolean,default:!1}},data:function(){return{access:[{name:"View"},{name:"Edit"},{name:"Manage"}],defaultOption:0}},computed:{isLocked:function(){return this.$props.loading||this.$props.locked}},watch:{componentData:function(){this.setDefault()}},created:function(){this.setDefault()},methods:{setDefault:function(){"VIEW"===this.$props.componentData.permission&&(this.defaultOption=0),"EDIT"===this.$props.componentData.permission&&(this.defaultOption=1),"MANAGE"===this.$props.componentData.permission&&(this.defaultOption=2)},sharedOptionType:function(t){return"org"===t?"Organization":"org group"===t?"Organization group":"User"},changeAccess:function(t){this.$emit("on-access-change",{componentData:this.$props.componentData,selected:t.selected})},deleteItem:function(){this.$emit("on-delete",{componentData:this.$props.componentData})}}};const ct={name:"PATabCollabList",components:{ListItem:(0,_.A)(rt,st,[],!1,null,null,null).exports},mixins:[d.A],props:{uid:{type:String,default:null},annotationId:{type:Number,required:!0}},data:function(){return{deleting:!1,loading:[]}},computed:{sharedWith:function(){return this.$store.getters["privateNotes/getPrivateAnnotationById"](this.$props.annotationId).shares},isShared:function(){return null!==this.sharedWith&&this.sharedWith.length>0},isThereOnlyOneManager:function(){var t=0;return this.sharedWith.forEach(function(e){"MANAGE"===e.permission&&t++}),1===t}},methods:{isOnlyManager:function(t){return this.isThereOnlyOneManager&&"MANAGE"===t.permission},isLoading:function(t){return this.loading.some(function(e){return e.share_id===t})},loadingAdd:function(t){this.loading.push({share_id:t})},loadingRemove:function(t){this.loading=this.loading.filter(function(e){return e.share_id!==t})},shareAPIDelete:function(t){var e=this;return new Promise(function(n,o){s.A.delete("".concat(e.$store.getters["user/getPortalURL"],"/unshare/").concat(t)).then(function(){e.$store.commit("privateNotes/deleteShareById",{annotation_id:e.$props.annotationId,share_id:t}),n(!0)}).catch(function(t){console.error(t),o(t)})})},shareDelete:function(t){var e=this;this.loadingAdd(t.componentData.share_id),this.shareAPIDelete(t.componentData.share_id).then(function(){e.$store.dispatch("privateNotes/updateCurrentUserRights",e.$props.annotationId).then(function(){e.$store.commit("sharedMessages/addPopupMessage",{type:"warning",title:"Private notes",text:"Stopped sharing with ".concat(t.componentData.shared_with_label),announce:"Stopped sharing with ".concat(t.componentData.shared_with_label),timeout:5e3}),(0,l.A)("#panel_collab_".concat(e.$props.uid))}).catch(function(t){403===t.response.status?e.$store.dispatch("privateNotes/deleteAnnotationById",e.$props.annotationId):console.error(t)})}).catch(function(t){e.$store.commit("sharedMessages/addPopupMessage",{type:"error",title:"Problem unsharing",text:"".concat(t),announce:"Problem unsharing: ".concat(t),timeout:5e3})}).finally(function(){e.loadingRemove(t.componentData.share_id)})},shareAPIAccessChange:function(t){var e=this;return new Promise(function(n,o){Boolean(t.share_id)&&Boolean(t.selected)&&["VIEW","EDIT","MANAGE"].some(function(e){return e===t.selected.name.toUpperCase()})||o(new Error("Bad edit share request"));var i={shared_content_id:e.$props.annotationId,shared_with_id:t.componentData.shared_with_id,shared_content_type:e.$store.getters["privateNotes/getAnnotationContentTypeID"],shared_with_type:t.componentData.shared_with_type,permission:t.selected.name.toUpperCase()};s.A.post("".concat(e.$store.getters["user/getPortalURL"],"/share"),i).then(function(o){var i={annotation_id:e.$props.annotationId,share_id:t.componentData.share_id,selected:o.data.permission};e.$store.commit("privateNotes/editShareAccessById",i),e.$store.dispatch("privateNotes/updateCurrentUserRights",e.$props.annotationId).then(function(){n()})}).catch(function(t){o(t)})})},shareAccessChange:function(t){var e=this;this.loadingAdd(t.componentData.share_id),this.shareAPIAccessChange(t).then(function(){e.$store.commit("sharedMessages/addPopupMessage",{type:"success",title:"Private notes",text:"Changed access level for ".concat(t.componentData.shared_with_label),announce:"Changed access level for ".concat(t.componentData.shared_with_label),timeout:5e3})}).catch(function(t){e.$store.commit("sharedMessages/addPopupMessage",{type:"error",title:"Problem changing access level",text:"".concat(t),announce:"Problem changing access level: ".concat(t),timeout:5e3}),console.error("Problem changing access level:",t)}).finally(function(){e.loadingRemove(t.componentData.share_id)})}}};const lt={name:"TabShare",components:{ShareSearch:it,ShareList:(0,_.A)(ct,at,[function(){var t=this,e=t._self._c;return e("header",{staticClass:"pa-collab-users__header"},[e("div",{staticClass:"pa-collab-users__header__label"},[t._v("\n        Shared with\n      ")]),t._v(" "),e("div",{staticClass:"pa-collab-users__header__access"},[t._v("\n        Sharing access level\n      ")])])}],!1,null,null,null).exports},props:{annotationId:{type:Number,required:!0}}};const ut={name:"Tabs",components:{TabShare:(0,_.A)(lt,j,[],!1,null,null,null).exports},props:{annotation:{type:Object,required:!0}},data:function(){return{tabs:[{id:"collab",name:"Sharing",active:!0}]}},computed:{tabCollabActive:function(){return this.tabs.some(function(t){return"collab"===t.id&&t.active})},tabTagsActive:function(){return this.tabs.some(function(t){return"tags"===t.id&&t.active})},hasManagePermission:function(){return"MANAGE"===this.$props.annotation.current_user_permissions.permission}},methods:{isTabActive:function(t){return this.tabs.some(function(e){return e.id===t&&e.active})},activateTab:function(t){var e=this;this.tabs.map(function(n){n.id===t?(n.active=!0,(0,l.A)("#pa-panel-".concat(t,"-").concat(e.$props.annotation.id))):n.active=!1})}}};const dt=(0,_.A)(ut,W,[],!1,null,null,null).exports,pt={name:"PrivateAnnotation",components:{CardView:p.A,AnnotationDate:P,Actions:v,AnnotationContent:B,AnnotationAuthor:y,AnnotationBreadcrumbs:H,Tabs:dt},mixins:[u.A,d.A],props:{annotation:{type:Object,required:!0},draft:{type:Boolean,default:!1}},data:function(){return{customMessages:{deleteDialogMessage:"Are you certain that you want to delete this note?",deleteDialogConfirm:"Yes, delete it!"},document_title:"",short_citation:""}},computed:{defaultActions:function(){return this.draft?{delete:!0,edit:!1}:{delete:"MANAGE"===this.$props.annotation.current_user_permissions.permission,edit:"EDIT"===this.$props.annotation.current_user_permissions.permission||"MANAGE"===this.$props.annotation.current_user_permissions.permission}},defaultViewMode:function(){return!0===this.$props.draft?r.A.EDIT_MODE:r.A.VIEW_MODE}},created:function(){var t=this;this.$props.draft?this.$store.dispatch("app/buildBreadCrumbsForURL",{url:this.$props.annotation.textranges[0].start_url}).then(function(e){var n,o;t.document_title=(null===(n=e[0])||void 0===n?void 0:n.label)||"",t.short_citation=(null===(o=e[1])||void 0===o?void 0:o.label)||""}):(this.document_title=this.$props.annotation.document_title,this.short_citation=this.$props.annotation.short_citation)},methods:{showTabs:function(t){return!this.draft&&t.mode===r.A.EDIT_MODE},deleteConfirmed:function(){var t=this;this.draft?this.deleteDraft():this.annotationDelete().then(function(){t.$store.dispatch("privateNotes/checkToolAvailability")})},onSave:function(t,e){this.draft?this.saveDraft(t):this.annotationSave(t,e)},onEditCancel:function(t,e){this.draft?this.deleteDraft():e&&e(),this.$emit("cancel-edit")},deleteDraft:function(){this.$store.commit("privateNotes/deletePrivateAnnotationDraft",this.$props.annotation.note_url),0===this.$store.getters["privateNotes/getPrivateAnnotationDrafts"].length&&(this.$store.commit("structure/setToolAvailable",{groupName:c.A.TOOL_GROUP_DOCUMENT,toolName:c.A.TOOL_DOCUMENT_PRIVATE_ANNOTATIONS_DRAFTS,isAvailable:!1}),this.$store.commit("structure/setActiveItem",c.A.TOOL_DOCUMENT_PRIVATE_ANNOTATIONS))},saveDraft:function(t){var e=this,n=this.$props.annotation;n.body=t,n.document_title=this.document_title,n.short_citation=this.short_citation,this.$store.dispatch("privateNotes/saveNewAnnotation",n).then(function(){e.$store.commit("sharedMessages/addPopupMessage",{type:"success",title:"Private notes",text:"New note has been saved",announce:"New note has been saved",timeout:5e3}),e.deleteDraft()})},saveDraftBody:function(t){this.draft&&t.trim()!==this.$props.annotation.body&&this.$store.commit("privateNotes/savePrivateAnnotationDraft",(0,i.A)((0,i.A)({},this.$props.annotation),{},{body:t}))},annotationAPISave:function(t){var e=this,n=this.$props.annotation;return new Promise(function(o,i){s.A.put("".concat(e.$store.getters["user/getPortalURL"],"/annotations/").concat(e.$props.annotation.id),{body:t,page_url:n.page_url.split("#")[0]}).then(function(t){a.default.set(n,"body",t.data.body),a.default.set(n,"body_plain",t.data.body_plain),o(!0)}).catch(function(t){console.error(t),i(t)})})},annotationSave:function(t,e){var n=this;t.trim()!==this.$props.annotation.body?this.annotationAPISave(t).then(function(){n.$store.commit("sharedMessages/addPopupMessage",{type:"success",title:"Private notes",text:"Note has been saved",announce:"Note has been saved",timeout:5e3}),e&&e()}).catch(function(t){var e=a.default.helpers.extractHTTPErrorMessage(t);n.$store.commit("sharedMessages/addPopupMessage",{type:"error",title:"Private notes",text:"Unable to save the note: ".concat(e),announce:"Unable to save the note: ".concat(e),timeout:5e3}),console.error("Unable to save the note:",t)}).finally(function(){(0,l.A)("#cardview-".concat(n.$props.annotation.id))}):(e&&e(),(0,l.A)("#cardview-".concat(this.$props.annotation.id)))},annotationAPIDelete:function(){var t=this;return new Promise(function(e,n){s.A.delete("".concat(t.$store.getters["user/getPortalURL"],"/annotations/").concat(t.$props.annotation.id)).then(function(){t.$store.dispatch("privateNotes/deleteAnnotationById",t.$props.annotation.id),e(t.$props.annotation)}).catch(function(t){console.error(t),n(t)})})},annotationDelete:function(){var t=this;return this.dialog.loading=!0,this.annotationAPIDelete().then(function(){t.$store.commit("sharedMessages/addPopupMessage",{type:"warning",title:"Private notes",text:"Note has been deleted",announce:"Note has been deleted",timeout:5e3}),(0,l.A)("#grid-sidebar__content")}).catch(function(e){var n=a.default.helpers.extractHTTPErrorMessage(e);t.$store.commit("sharedMessages/addPopupMessage",{type:"error",title:"Unable to delete the note",text:n,announce:"Unable to delete the note: ".concat(n),timeout:5e3}),console.error("Unable to delete the note:",e),(0,l.A)("#pa-annotation-".concat(t.annotationId)).then(function(){t.dialog.visible=!1,t.actions.trash=!1})}).finally(function(){t.dialog.loading=!1})}}};const ht=(0,_.A)(pt,o,[],!1,null,null,null).exports},9271(t,e,n){n.d(e,{A:()=>o});const o={data:function(){return{dialog:{visible:!1,loading:!1,value:null,type:null,msg:{question:null,cancel:null,confirm:null}}}},methods:{dialogReset:function(){this.dialog.visible=!1,this.dialog.value=null,this.dialog.type=null,this.dialog.msg.question=null,this.dialog.msg.cancel=null,this.dialog.msg.confirm=null}}}}}]);